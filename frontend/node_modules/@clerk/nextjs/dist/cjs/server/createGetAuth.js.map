{"version":3,"sources":["../../../src/server/createGetAuth.ts"],"sourcesContent":["import type { AuthObject } from '@clerk/backend';\nimport { constants } from '@clerk/backend/internal';\nimport { decodeJwt } from '@clerk/backend/jwt';\nimport { isTruthy } from '@clerk/shared/underscore';\n\nimport { withLogger } from '../utils/debugLogger';\nimport { getAuthDataFromRequest } from './data/getAuthDataFromRequest';\nimport { getAuthAuthHeaderMissing } from './errors';\nimport type { RequestLike } from './types';\nimport { assertAuthStatus, getCookie, getHeader } from './utils';\n\nexport const createGetAuth = ({\n  noAuthStatusMessage,\n  debugLoggerName,\n}: {\n  debugLoggerName: string;\n  noAuthStatusMessage: string;\n}) =>\n  withLogger(debugLoggerName, logger => {\n    return (req: RequestLike, opts?: { secretKey?: string }): AuthObject => {\n      if (isTruthy(getHeader(req, constants.Headers.EnableDebug))) {\n        logger.enable();\n      }\n\n      assertAuthStatus(req, noAuthStatusMessage);\n\n      return getAuthDataFromRequest(req, { ...opts, logger });\n    };\n  });\n\nexport const getAuth = createGetAuth({\n  debugLoggerName: 'getAuth()',\n  noAuthStatusMessage: getAuthAuthHeaderMissing(),\n});\n\nexport const parseJwt = (req: RequestLike) => {\n  const cookieToken = getCookie(req, constants.Cookies.Session);\n  const headerToken = getHeader(req, 'authorization')?.replace('Bearer ', '');\n  return decodeJwt(cookieToken || headerToken || '');\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,sBAA0B;AAC1B,iBAA0B;AAC1B,wBAAyB;AAEzB,yBAA2B;AAC3B,oCAAuC;AACvC,oBAAyC;AAEzC,mBAAuD;AAEhD,MAAM,gBAAgB,CAAC;AAAA,EAC5B;AAAA,EACA;AACF,UAIE,+BAAW,iBAAiB,YAAU;AACpC,SAAO,CAAC,KAAkB,SAA8C;AACtE,YAAI,gCAAS,wBAAU,KAAK,0BAAU,QAAQ,WAAW,CAAC,GAAG;AAC3D,aAAO,OAAO;AAAA,IAChB;AAEA,uCAAiB,KAAK,mBAAmB;AAEzC,eAAO,sDAAuB,KAAK,EAAE,GAAG,MAAM,OAAO,CAAC;AAAA,EACxD;AACF,CAAC;AAEI,MAAM,UAAU,cAAc;AAAA,EACnC,iBAAiB;AAAA,EACjB,yBAAqB,wCAAyB;AAChD,CAAC;AAEM,MAAM,WAAW,CAAC,QAAqB;AAnC9C;AAoCE,QAAM,kBAAc,wBAAU,KAAK,0BAAU,QAAQ,OAAO;AAC5D,QAAM,eAAc,iCAAU,KAAK,eAAe,MAA9B,mBAAiC,QAAQ,WAAW;AACxE,aAAO,sBAAU,eAAe,eAAe,EAAE;AACnD;","names":[]}